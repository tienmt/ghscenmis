% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/all_function.R
\name{ghs_missing_gibbs}
\alias{ghs_missing_gibbs}
\title{Gibbs Sampler for Gaussian Graphical Model with Missing Data and Horseshoe Prior}
\usage{
ghs_missing_gibbs(
  Y,
  n_iter = 3000,
  burnin = 1000,
  thin = 1,
  eta = 0.01,
  verbose = TRUE,
  store_Z = FALSE,
  seed = NULL,
  a0 = 0.01,
  b0 = 0.01,
  symmetrize = c("average", "min", "max")
)
}
\arguments{
\item{Y}{Numeric matrix of size n x p with observations; may contain NAs.}

\item{n_iter}{Integer. Total number of Gibbs sampler iterations. Default 3000.}

\item{burnin}{Integer. Number of burn-in iterations to discard. Default 1000.}

\item{thin}{Integer. Thinning interval for storage. Default 5.}

\item{eta}{Numeric. Small regularization parameter for numerical stability. Default 1e-2.}

\item{verbose}{Logical. Print progress messages during sampling. Default TRUE.}

\item{store_Z}{Logical. If TRUE, stores sampled latent Z matrices. Default FALSE.}

\item{seed}{Integer. Random seed for reproducibility. Default NULL.}

\item{a0}{Numeric. Shape parameter for inverse-gamma prior on residual variances. Default 1e-2.}

\item{b0}{Numeric. Rate parameter for inverse-gamma prior on residual variances. Default 1e-2.}

\item{symmetrize}{Character. Method to symmetrize the precision matrix: "average", "min", or "max". Default "average".}
}
\value{
A list containing:
\describe{
\item{Omega_draws}{Array of sampled precision matrices, dimension p x p x n_keep.}
\item{Omega_mean}{Posterior mean of Omega.}
\item{Omega_median}{Posterior median of Omega.}
\item{Z_draws}{Array of imputed latent Z matrices (if \code{store_Z = TRUE}).}
\item{settings}{List of sampler settings.}
}
}
\description{
Performs Bayesian estimation of a precision matrix for a Gaussian Graphical Model (GGM)
when the data contains missing entries. Missing values are imputed using the
conditional multivariate normal distribution, and node-wise regressions are
regularized with the horseshoe prior.
}
\details{
The function implements a Gibbs sampler with the following steps:
\enumerate{
\item Impute missing values in Y using the conditional multivariate normal.
\item Perform node-wise linear regressions of each variable on all others,
using the horseshoe prior for sparsity regularization.
\item Reconstruct the precision matrix Omega from the regression coefficients.
\item Symmetrize Omega according to the chosen method, and optionally project to SPD.
}
Local and global horseshoe parameters are updated using standard conjugate Gibbs steps.
}
\examples{
\dontrun{
set.seed(123)
Y <- matrix(rnorm(100*5), 100, 5)
Y[sample(length(Y), 10)] <- NA
fit <- ghs_missing_gibbs( Y, n_iter = 100, burnin = 50, thin = 2)
fit$Omega_mean

}
}
\references{
Makalic, E., & Schmidt, D. F. (2016). A simple sampler for the horseshoe estimator.
\emph{IEEE Signal Processing Letters}, 23(1), 179-182.
}
