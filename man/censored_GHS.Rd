% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/all_function.R
\name{censored_GHS}
\alias{censored_GHS}
\title{Gibbs Sampler for Censored Graphical Horseshoe Precision Matrix Estimation}
\usage{
censored_GHS(
  Ytilde,
  cvec,
  n_iter = 2000L,
  burn = 1000L,
  thin = 1L,
  a0 = 0.01,
  b0 = 0.01,
  symmetrize = "average",
  project_spd = FALSE,
  verbose = TRUE,
  right_or_left = "left"
)
}
\arguments{
\item{Ytilde}{A numeric matrix of dimension \eqn{n \times p} containing the \strong{observed}
values after censoring. For left censoring, values satisfy \eqn{Y_{ij} = \max(Z_{ij}, c_j)}.}

\item{cvec}{A numeric vector of length \eqn{p} giving censoring thresholds for each variable.
Interpreted as \strong{left}-censoring by default; use \code{right_or_left} to switch.}

\item{n_iter}{Total number of MCMC iterations.}

\item{burn}{Number of burn-in iterations to discard.}

\item{thin}{Thinning interval for storing posterior draws.}

\item{a0}{Hyperparameters for the global horseshoe scale parameter.}

\item{b0}{Hyperparameters for the global horseshoe scale parameter.}

\item{symmetrize}{Method used to enforce symmetry of sampled precision matrices.
One of \code{"average"} (default), \code{"lower"}, or \code{"upper"}.}

\item{project_spd}{Logical; if \code{TRUE}, enforces positive-definiteness via nearest SPD projection.}

\item{verbose}{Logical; if \code{TRUE}, prints progress during sampling.}

\item{right_or_left}{\code{"left"} (default) for left-censored data or \code{"right"} for right-censoring.}
}
\value{
A list containing:
\describe{
\item{Omega_mean}{Posterior mean of the precision matrix (after burn-in and thinning).}
\item{Omega_draws}{Array of dimension \eqn{p \times p \times m} containing posterior draws,
where \eqn{m = (n\_iter - burn)/thin}.}
\item{Sigma_mean}{Posterior mean of the covariance matrix.}
\item{latent_Z}{Posterior draws of the imputed latent uncensored data.}
\item{tau2_global}{Posterior draws of the global horseshoe scale parameter.}
}
}
\description{
Implements a Gibbs sampler for estimating a sparse precision matrix
under the \strong{Graphical Horseshoe (GHS)} prior when the data are
\strong{censored} (left- or right-censored). The sampler is fully implemented in C++
for computational efficiency.

Given observations \eqn{Y^{\mathrm{tilde}} \in \mathbb{R}^{n \times p}} where
each variable may be censored at a known threshold, the algorithm alternates
between:
\itemize{
\item Sampling latent uncensored values from truncated normals.
\item Updating the precision matrix \eqn{\Omega} using Graphical Horseshoe shrinkage.
}
}
\details{
This function implements a censored-data extension of the Graphical Horseshoe
sampler from li2019graphical GHS.
Latent Gaussian variables are sampled from truncated normal distributions
conditional on the censoring mechanism. The precision matrix is updated using
fully conditional Gaussianâ€“Horseshoe steps.
}
\examples{
\dontrun{
set.seed(123)
p <- 10
n <- 200

# True covariance with a 3-node block structure
Sigma_true <- diag(p)
Sigma_true[1, 2] <- Sigma_true[2, 1] <-
  Sigma_true[1, 3] <- Sigma_true[3, 1] <-
  Sigma_true[2, 3] <- Sigma_true[3, 2] <- 0.5

Omega_true <- solve(Sigma_true)
E_true <- 1 * (abs(Omega_true) > 1e-6)
diag(E_true) <- 0

# Generate data
Z <- MASS::mvrnorm(n, rep(0, p), Sigma_true)

# Apply variable-wise left-censoring at thresholds
cvec <- rep(c(-0.5, 0.5), length.out = p)
Y <- pmax(Z, matrix(cvec, n, p, byrow = TRUE))

# Fit censored Graphical Horseshoe
fit <- censored_GHS(
  Ytilde = Y,
  cvec = cvec,
  n_iter = 6000,
  burn = 1000,
  verbose = FALSE
)

# Posterior mean precision
Omega_hat <- fit$Omega_mean

# Edge selection
E_est <- get_edge_selection_ci(fit$Omega_draws)$E_est

# Evaluate accuracy
c(
  MSE = sum((Omega_hat - Omega_true)^2),
  get_edge_metrics(E_true, E_est)
)
}


}
